"use strict";class e{constructor(t,s,i){this.gl=t;const r=e.compileShader(t,t.VERTEX_SHADER,s),h=e.compileShader(t,t.FRAGMENT_SHADER,i);this.glProgram=e.createProgram(t,r,h),this.uniforms=this._getActiveUniforms()}use(){this.gl.useProgram(this.glProgram)}setUniform(e,t){const s=this.uniforms[e];if(s)return s.setter(s.location,t)}_getActiveUniforms(){const e={},t=this.gl.getProgramParameter(this.glProgram,this.gl.ACTIVE_UNIFORMS);for(let s=0;s<t;s++){const t=this.gl.getActiveUniform(this.glProgram,s);e[t.name]={location:this.gl.getUniformLocation(this.glProgram,t.name),setter:this._getUniformSetter(t.type),type:t.type}}return e}_getUniformSetter(e){switch(e){case this.gl.FLOAT:return(e,t)=>{this.gl.uniform1f(e,t)};case this.gl.FLOAT_VEC2:return(e,t)=>{this.gl.uniform2fv(e,t)};case this.gl.FLOAT_VEC3:return(e,t)=>{this.gl.uniform3fv(e,t)};case this.gl.FLOAT_VEC4:return(e,t)=>{this.gl.uniform4fv(e,t)};case this.gl.INT:case this.gl.BOOL:case this.gl.UNSIGNED_INT:case this.gl.SAMPLER_2D:return(e,t)=>{this.gl.uniform1i(e,t)};case this.gl.INT_VEC2:case this.gl.BOOL_VEC2:case this.gl.UNSIGNED_INT_VEC2:return(e,t)=>{this.gl.uniform2iv(e,t)};case this.gl.INT_VEC3:case this.gl.BOOL_VEC3:case this.gl.UNSIGNED_INT_VEC3:return(e,t)=>{this.gl.uniform3iv(e,t)};case this.gl.INT_VEC4:case this.gl.BOOL_VEC4:case this.gl.UNSIGNED_INT_VEC4:return(e,t)=>{this.gl.uniform4iv(e,t)};case this.gl.FLOAT_MAT2:return(e,t)=>{this.gl.uniformMatrix2fv(e,!1,t)};case this.gl.FLOAT_MAT3:return(e,t)=>{this.gl.uniformMatrix3fv(e,!1,t)};case this.gl.FLOAT_MAT4:return(e,t)=>{this.gl.uniformMatrix4fv(e,!1,t)}}}static compileShader(e,t,s){const i=e.createShader(t);return e.shaderSource(i,s),e.compileShader(i),i}static createProgram(e,t,s){const i=e.createProgram();e.attachShader(i,t),e.attachShader(i,s),e.linkProgram(i);return e.getProgramParameter(i,e.LINK_STATUS)?i:(console.error(`Program linking failed: ${e.getProgramInfoLog(i)}`),console.error(`Vertex shader info log: ${e.getShaderInfoLog(t)}`),console.error(`Fragment shader info log: ${e.getShaderInfoLog(s)}`),e.deleteShader(t),e.deleteShader(s),void e.deleteProgram(i))}}const t={resizeCanvasToDisplaySize:function(e,t){t=t||1;const s=e.clientWidth*t|0,i=e.clientHeight*t|0;return(e.width!==s||e.height!==i)&&(e.width=s,e.height=i,!0)}};exports.Framebuffer=class{constructor(e,t,s,...i){this.gl=e,this.width=t,this.height=s,this.glFramebuffer=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this.glFramebuffer);for(const t of i)t instanceof WebGLRenderbuffer?e.framebufferRenderbuffer(e.FRAMEBUFFER,t.type,e.RENDERBUFFER,t.texture):e.framebufferTexture2D(e.FRAMEBUFFER,t.type,e.TEXTURE_2D,t.texture,t.level||0)}bind(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.glFramebuffer),this.gl.viewport(0,0,this.width,this.height)}},exports.KeyInput=class{constructor(e){this.domElement=e,this.keys={},this._addEventListeners()}_addEventListeners(){this.domElement.addEventListener("keydown",this._keyPressed.bind(this)),this.domElement.addEventListener("keyup",this._keyReleased.bind(this))}_setInputs(e,t){switch(e.keyCode){case 37:case 65:this.left=t;break;case 39:case 68:this.right=t;break;case 38:case 87:this.up=t;break;case 40:case 83:this.down=t;break;case 32:this.space=t;break;case 16:this.shift=t;break;case 81:this.q=t;break;case 69:this.e=t;break;case 17:this.ctrl=t;break;case 67:this.c=t}}_keyPressed(e){this._setInputs(e,!0)}_keyReleased(e){this._setInputs(e,!1)}},exports.MouseInput=class{constructor(e){this.domElement=e,this.x=0,this.y=0,this.prevX=0,this.prevY=0,this.scroll=0,this.isPressed=!1,this.buttonLeft=!1,this.buttonRight=!1,this._addEventListeners()}_addEventListeners(){this.domElement.addEventListener("mousemove",this._mouseMoved.bind(this)),this.domElement.addEventListener("touchmove",this._mouseMoved.bind(this),{passive:!0}),this.domElement.addEventListener("mousedown",this._mousePressed.bind(this)),this.domElement.addEventListener("touchstart",this._mousePressed.bind(this),{passive:!0}),this.domElement.addEventListener("mouseup",this._mouseReleased.bind(this)),this.domElement.addEventListener("touchend",this._mouseReleased.bind(this)),this.domElement.addEventListener("mouseleave",this._mouseReleased.bind(this)),this.domElement.addEventListener("touchleave",this._mouseReleased.bind(this)),this.domElement.addEventListener("wheel",this._mouseScrolled.bind(this),{passive:!0})}_mouseMoved(e){let t=null!=e.clientX?e.clientX:e.touches[0].clientX,s=null!=e.clientY?e.clientY:e.touches[0].clientY,i=this.domElement.getBoundingClientRect();this.x=t-i.left,this.y=s-i.top}_mousePressed(e){let t=null!=e.clientX?e.clientX:e.touches[0].clientX,s=null!=e.clientY?e.clientY:e.touches[0].clientY,i=this.domElement.getBoundingClientRect();this.x=t-i.left,this.y=s-i.top,this.prevX=this.x,this.prevY=this.y,this.isPressed=!0,0==e.button&&(this.buttonLeft=!0),2==e.button&&(this.buttonRight=!0),e.touches&&e.touches.length>1&&(this.buttonRight=!0)}_mouseReleased(e){this.pressed=!1,this.buttonLeft=!1,this.buttonRight=!1}_mouseScrolled(e){this.scroll=e.deltaY}},exports.Renderbuffer=class{constructor(e,{width:t=1024,height:s=1024,format:i=e.DEPTH_COMPONENT24}={}){const r=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,r),e.renderbufferStorage(e.RENDERBUFFER,i,t,s)}bind(){this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,this.glRenderbuffer)}},exports.ShaderProgram=e,exports.Texture=class{constructor(e,{width:t=512,height:s=512,internalformat:i=e.RGBA,format:r=e.RGBA,type:h=e.UNSIGNED_BYTE,data:n=null,minFilter:o=e.LINEAR,magFilter:a=e.LINEAR,wrapMode:l=e.CLAMP_TO_EDGE}={}){this.gl=e,this.width=t,this.height=s,this.glTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.glTexture),e.texImage2D(e.TEXTURE_2D,0,i,t,s,0,r,h,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,l),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,l)}bind(e){this.gl.activeTexture(this.gl.TEXTURE0+e||0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.glTexture)}},exports.Utils=t;
